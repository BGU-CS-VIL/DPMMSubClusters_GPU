#include "pch.h"
#include "gtest/gtest.h"
#include "priors/niw.h"
#include "Eigen/Dense"
#include "dp_parallel_sampling.h"
#include "data_generators.h"
#include "priors/niw_hyperparams.h"
#include "priors/niw_sufficient_statistics.h"
#include "myCudaKernel.h"

namespace DPMMSubClustersTest
{
	TEST(niw_test, CreateSufficientStatistics)
	{
		niw object;
		VectorXd m(2);
		m << 0.0, 0.0;
		MatrixXd psi(2, 2);
		psi << 1.0, 0.0, 0.0, 1.0;
		std::shared_ptr<niw_hyperparams> prior = std::make_shared<niw_hyperparams>(1.0, m, 5.0, psi);
		std::shared_ptr<hyperparams> posterior = prior->clone();
		MatrixXd points(2, 10);
		points << -1.5580771, -1.8853954, -1.7104398, -0.8927666, 12.372295, 11.839552, 5.025442, 5.809215, -23.470015, -24.226057, 4.9351344, 4.256654, 5.218151, 4.0470524, 6.8685904, 7.0217624, 1.4795746, 1.9674032, -4.5789967, -5.0106354;

		std::shared_ptr<sufficient_statistics> resultBase = object.create_sufficient_statistics(prior, posterior, points);
		niw_sufficient_statistics* result = dynamic_cast<niw_sufficient_statistics*>(resultBase.get());

		ASSERT_EQ(10, result->N);
		ASSERT_NEAR(-18.6962, result->points_sum(0), 0.0001);
		ASSERT_NEAR(26.2046, result->points_sum(1), 0.0001);
		ASSERT_NEAR(1499.6991, result->S(0, 0), 0.0001);
		ASSERT_NEAR(387.5832, result->S(0, 1), 0.0001);
		ASSERT_NEAR(387.5832, result->S(1, 0), 0.0001);
		ASSERT_NEAR(234.69856, result->S(1, 1), 0.0001);
	}

	TEST(niw_test, CalcPosterior)
	{
		niw object;
		VectorXd m(2);
		m << 0.0, 0.0;
		MatrixXd psi(2, 2);
		psi << 1.0, 0.0, 0.0, 1.0;
		std::shared_ptr<niw_hyperparams> prior = std::make_shared<niw_hyperparams>(1.0, m, 5.0, psi);
		VectorXd points_sum(2);
		points_sum << -350136.8831217289, 59746.60001641512;
		MatrixXd S(2, 2);
		S << 4.793410496828892e6, -343002.59694666235, -343002.59694666235, 206659.1114939735;

		std::shared_ptr<niw_sufficient_statistics> ss = std::make_shared<niw_sufficient_statistics>(37196, points_sum, S);
		std::shared_ptr<hyperparams> resultBase = object.calc_posterior(prior, ss);
		niw_hyperparams* result = dynamic_cast<niw_hyperparams*>(resultBase.get());

		ASSERT_NEAR(40.255979361037014, result->psi(0, 0), 0.0001);
		ASSERT_NEAR(5.897545600162242, result->psi(0, 1), 0.0001);
		ASSERT_NEAR(5.897545600162242, result->psi(1, 0), 0.0001);
		ASSERT_NEAR(2.975669253988425, result->psi(1, 1), 0.0001);
	}

	TEST(niw_test, CreateHyperparams)
	{
		std::string strJson = "{\"m\":[1.0,2.0],\"psi\":[[1.0,0.0],[0.0,1.0]],\"k\":1,\"v\":5.0}";
		Json::Value root;
		Json::Reader reader;
		reader.parse(strJson.c_str(), root);

		niw object;
		std::shared_ptr<hyperparams> resultBase = object.create_hyperparams(root);
		niw_hyperparams* result = dynamic_cast<niw_hyperparams*>(resultBase.get());

		ASSERT_EQ(2, result->m.size());
		ASSERT_EQ(1.0, result->m(0));
		ASSERT_EQ(2.0, result->m(1));
		ASSERT_EQ(2, result->psi.rows());
		ASSERT_EQ(2, result->psi.cols());
		ASSERT_EQ(1.0, result->psi(0, 0));
		ASSERT_EQ(0.0, result->psi(0, 1));
		ASSERT_EQ(0.0, result->psi(1, 0));
		ASSERT_EQ(1.0, result->psi(1, 1));
		ASSERT_EQ(1, result->k);
		ASSERT_EQ(5.0, result->v);
	}

	TEST(niw_test, CreateHyperparamsNoM)
	{
		std::string strJson = "{\"psi\":[[1.0,0.0],[0.0,1.0]],\"k\":1,\"v\":5.0}";
		Json::Value root;
		Json::Reader reader;
		reader.parse(strJson.c_str(), root);

		niw object;
		std::shared_ptr<hyperparams> resultBase = object.create_hyperparams(root);
		niw_hyperparams* result = dynamic_cast<niw_hyperparams*>(resultBase.get());

		ASSERT_EQ(0, result->m.size());
		ASSERT_EQ(2, result->psi.rows());
		ASSERT_EQ(2, result->psi.cols());
		ASSERT_EQ(1.0, result->psi(0, 0));
		ASSERT_EQ(0.0, result->psi(0, 1));
		ASSERT_EQ(0.0, result->psi(1, 0));
		ASSERT_EQ(1.0, result->psi(1, 1));
		ASSERT_EQ(1, result->k);
		ASSERT_EQ(5.0, result->v);
	}

	TEST(niw_test, CreateHyperparamsNoPsi)
	{
		std::string strJson = "{\"m\":[1.0,2.0],\"k\":1,\"v\":5.0}";
		Json::Value root;
		Json::Reader reader;
		reader.parse(strJson.c_str(), root);

		niw object;
		std::shared_ptr<hyperparams> resultBase = object.create_hyperparams(root);
		niw_hyperparams* result = dynamic_cast<niw_hyperparams*>(resultBase.get());

		ASSERT_EQ(2, result->m.size());
		ASSERT_EQ(1.0, result->m(0));
		ASSERT_EQ(2.0, result->m(1));
		ASSERT_EQ(0, result->psi.rows());
		ASSERT_EQ(0, result->psi.cols());
		ASSERT_EQ(1, result->k);
		ASSERT_EQ(5.0, result->v);
	}

	TEST(niw_test, CreateHyperparamsNoK)
	{
		std::string strJson = "{\"m\":[1.0,2.0],\"psi\":[[1.0,0.0],[0.0,1.0]],\"v\":5.0}";
		Json::Value root;
		Json::Reader reader;
		reader.parse(strJson.c_str(), root);

		niw object;
		std::shared_ptr<hyperparams> resultBase = object.create_hyperparams(root);
		niw_hyperparams* result = dynamic_cast<niw_hyperparams*>(resultBase.get());

		ASSERT_EQ(2, result->m.size());
		ASSERT_EQ(1.0, result->m(0));
		ASSERT_EQ(2.0, result->m(1));
		ASSERT_EQ(2, result->psi.rows());
		ASSERT_EQ(2, result->psi.cols());
		ASSERT_EQ(1.0, result->psi(0, 0));
		ASSERT_EQ(0.0, result->psi(0, 1));
		ASSERT_EQ(0.0, result->psi(1, 0));
		ASSERT_EQ(1.0, result->psi(1, 1));
		ASSERT_EQ(0, result->k);
		ASSERT_EQ(5.0, result->v);
	}

	TEST(niw_test, CreateHyperparamsNoV)
	{
		std::string strJson = "{\"m\":[1.0,2.0],\"psi\":[[1.0,0.0],[0.0,1.0]],\"k\":1}";
		Json::Value root;
		Json::Reader reader;
		reader.parse(strJson.c_str(), root);

		niw object;
		std::shared_ptr<hyperparams> resultBase = object.create_hyperparams(root);
		niw_hyperparams* result = dynamic_cast<niw_hyperparams*>(resultBase.get());

		ASSERT_EQ(2, result->m.size());
		ASSERT_EQ(1.0, result->m(0));
		ASSERT_EQ(2.0, result->m(1));
		ASSERT_EQ(2, result->psi.rows());
		ASSERT_EQ(2, result->psi.cols());
		ASSERT_EQ(1.0, result->psi(0, 0));
		ASSERT_EQ(0.0, result->psi(0, 1));
		ASSERT_EQ(0.0, result->psi(1, 0));
		ASSERT_EQ(1.0, result->psi(1, 1));
		ASSERT_EQ(1, result->k);
		ASSERT_EQ(0.0, result->v);
	}

	TEST(niw_test, LogMarginalLikelihood_Dim3)
	{
		int D = 3;
		niw object;
		VectorXd m(D);
		MatrixXd psi = MatrixXd::Identity(D, D);
		MatrixXd psi_posterior(D, D);
		psi_posterior << 2.83857634967319, 0.7983113895673629, -0.3799488121072959, 0.7983113895673629, 0.443757742084228, -0.1421242774011495, -0.3799488121072959, -0.1421242774011495, 0.250752571527646;
		VectorXd points_sum(D);
		MatrixXd S(D, D);

		std::shared_ptr<niw_hyperparams> prior = std::make_shared<niw_hyperparams>(1.0, m, D, psi);
		std::shared_ptr<niw_hyperparams> posterior = std::make_shared<niw_hyperparams>(4862, m, 4864, psi_posterior);

		std::shared_ptr<niw_sufficient_statistics> ss = std::make_shared<niw_sufficient_statistics>(4861, points_sum, S);

		double result = object.log_marginal_likelihood(prior, posterior, ss);

		ASSERT_NEAR(-15590.001719097832, result, 0.001);
	}

	TEST(niw_test, LogMarginalLikelihood_Dim50)
	{
		int D = 50;
		niw object;
		VectorXd m(D);
		MatrixXd psi = MatrixXd::Identity(D, D);
		MatrixXd psi_posterior(D, D);
		psi_posterior << 4.719985843463077, 0.2721213280991424, 1.0105857986552003, -1.6738602117910617, 1.428965204766633, -1.1509318648470925, 0.12094473192052517, -0.27853788399708546, 0.5450177682240106, -0.06951721083127402, -2.302284395552517, -0.6998123882314379, 2.3891537968036354, -1.0389877955828672, -1.663486913848699, -1.7729154781009537, -0.8216031854605208, 0.9521165985517603, -0.8369327462907251, -0.3219432147090234, -1.5106725189047896, -0.7638337973535647, 0.9215681861349113, 1.7915372694477574, 1.7233694752876005, -1.1135846709595885, 0.21134692386913798, 2.048841196772891, 2.5848581285076215, 0.4591547533297519, 0.4866979337185299, -0.8686349111349915, -2.756886513921411, 1.4355360924708305, 2.916604858302512, -1.6469966428420402, 0.04544239512902233, 1.624097404137155, 0.9869074051582544, -0.22531687540564085, -1.18358591063745, -0.23533781903323686, -0.03716820663311902, 0.6547433848685114, -0.06363573352240258, -0.18415499069420413, -0.9307530712636556, 0.743782453557428, -1.8803918036482234, -0.4668592796252492, 0.2721213280991424, 0.11371035743633777, 0.047470092034366515, -0.10085730194748134, 0.1715434538002138, 0.04297847024040111, 0.05889996042592024, -0.011385339366401107, -0.0534495823153091, 0.05441876025491463, -0.2257627761077027, -0.0148341085612915, 0.1589771509711183, -0.05531317323926046, -0.05465743520253517, -0.08404022526630962, -0.14259579844755682, 0.1007660148981306, -0.019541581140436005, -0.07440515326138473, -0.21599980342699804, 0.05421816726789701, 0.007096273349033612, 0.1033506720194727, 0.1965506910549747, 0.01848711282534558, -0.012714112876527399, 0.15692105208513493, 0.14142059578312344, -0.054385864672465735, 0.03712640033401871, -0.16902785133763512, -0.2897601460377601, -0.0388560335221398, 0.1653866030284994, -0.14649424075209475, -0.08385666884292417, 0.2328507681290349, -0.03517568069718802, 0.030958022470706954, -0.03708569625167789, 0.012839118949287808, 0.08751778969970568, -0.09656049348214375, -0.09996088573351065, 0.03191737279015718, -0.06953590097874822, 0.053579488761997196, -0.11913292472464912, -0.02178523062533816, 1.0105857986552003, 0.047470092034366515, 0.4572837284008581, -0.28090309335038044, 0.37649195753364495, -0.21017781343956143, 0.13712763997107277, 0.06340865783443779, 0.07031157045405423, 0.11778266855027704, -0.5381378151463482, -0.11970374926672725, 0.5012878322986749, -0.18454910853254766, -0.3233879309478448, -0.41264156114636596, -0.2246596321621426, 0.2322156552247173, -0.2653948563379659, -0.10105176446494724, -0.4491863208825325, -0.07236553777755113, 0.19175478974456023, 0.39224245584777, 0.43723464108814053, -0.23412078079658416, 0.10513304813994796, 0.4691010906545292, 0.562058177046131, 0.015166077144288768, 0.1414714142121072, -0.19894084995664787, -0.6115952657468746, 0.3304999252087013, 0.6984143854986102, -0.41640779330437494, 0.03509780709619646, 0.34528595267109635, 0.17234246772302725, -0.09366651806702184, -0.20971266112192555, -0.028231959519766724, 0.16552048491654733, 0.154983642983464, -0.10499133940512975, 0.012867289597941643, -0.2531285803478732, 0.1462637208309831, -0.38404891135617947, -0.04933051323246521, -1.6738602117910617, -0.10085730194748134, -0.28090309335038044, 1.0131414782157757, -1.0558461878279368, 0.31342994298769544, -0.054098907667011864, 0.22998844453645165, -0.1438067066072319, -0.2530340089974043, 1.1431644557989153, 0.37464862161465967, -0.848809463335942, 0.4295743249886676, 0.5886736144725792, 0.692257106453809, 0.6254572428672502, -0.38272764524000286, 0.20098438987407624, 0.21039497776085248, 0.9526917075328841, -0.03349423822629476, -0.3947450602903357, -0.8085306872205068, -1.3600972359735863, 0.0045549448742518645, 0.09987703084385903, -1.3328351681451054, -0.934817605875236, -0.11303117818818405, -0.32877753954289596, 0.7069785441574208, 1.588061328207695, -0.32647557278472406, -0.8022994854466539, 0.9087616662236305, 0.3161647765159817, -0.845100232955722, -0.012943830707756041, -0.3169288769251217, 0.25014647555631386, 0.2422854845679856, -0.11782381468490058, -0.06919785135342978, 0.45998659700263045, 0.05087935847321473, 0.1993767063873512, -0.32503580899155715, 1.157977081271793, 0.2070891548902233, 1.428965204766633, 0.1715434538002138, 0.37649195753364495, -1.0558461878279368, 3.315853953752747, 0.3566977853703341, 0.9909551103181282, 0.14554672307701724, 0.16684228022920483, 1.173024695196443, -2.3280054064394977, -0.4846721294264257, 0.8382531411269906, 0.12474331850799816, -0.1241035261260924, -0.5155431981944556, -1.3584452854834488, 0.11702193684941985, -0.3940056828489261, 0.25638034164186896, -2.7000873901880067, 1.9190237612863075, 0.2911196731417783, 0.5994396521812264, 3.3512325257229625, 1.3039834549645284, -0.11715134415358257, 2.6850441053566256, 0.9459190779217233, -0.1785684851966738, 0.8126348262430809, -1.308882472048767, -2.8142611895198835, -0.08854748059765666, -0.43830659211881345, -1.9311268904861627, -0.9324547956626685, 0.9506334999473403, -0.6728884119252186, 0.7662668127801423, 0.1926272293734586, -0.4568156667179388, 0.8754690435351562, -0.7900251493359477, -2.003271724834259, 0.2777578229967351, -0.30645908870063, -0.10833526433681367, -1.7863204879471593, 0.13571938994736713, -1.1509318648470925, 0.04297847024040111, -0.21017781343956143, 0.31342994298769544, 0.3566977853703341, 0.7101312498561232, 0.29250381110610996, 0.14588072698152105, -0.2934232783923329, 0.33881071662046497, 0.07462107309692607, 0.18270595860613098, -0.5084970751775678, 0.3309144371137974, 0.5362408972498497, 0.4786939447889209, -0.1755048234451933, -0.16731655509292764, 0.2005123484502365, 0.07174626846789701, -0.32815364452546614, 0.7245806114171184, -0.2907716689866391, -0.3948091062336446, 0.23710991895888645, 0.6713601784793372, -0.1358618833244379, -0.08070535665535211, -0.5530879535926385, -0.3760894532944277, 0.07296703881803836, -0.14218198717260347, 0.06899742128077524, -0.622516877022471, -0.8879741766082235, -0.001583051698068681, -0.34963367571006027, -0.09347529983994636, -0.5875878961614104, 0.19234790858421555, 0.426873756183646, 0.061036083035421, 0.35764243354216557, -0.546343197606633, -0.489160123898812, 0.1709531714519369, 0.20743010918074337, -0.2504484543176086, 0.22222332014760846, 0.14202399185340595, 0.12094473192052517, 0.05889996042592024, 0.13712763997107277, -0.054098907667011864, 0.9909551103181282, 0.29250381110610996, 0.5148194101096022, 0.19215046171109026, -0.01777412335592467, 0.3849731954908426, -0.6072622785608595, -0.04187422425440287, 0.09413029864799329, 0.227060514808576, 0.12823634657060862, -0.0005565306836198935, -0.3812169909627012, -0.018205277886400674, -0.16375846595323978, 0.16604923673395422, -0.8619602650105631, 0.7544460363665826, -0.0069816728057622, -0.02809557916941242, 0.86433601887177, 0.4338201783254598, -0.00868154448958001, 0.5972946723603575, 0.19743976801496757, -0.18495098345289088, 0.2697553394683959, -0.257322956524922, -0.6262125434319477, -0.10401433154670481, -0.29639599418589135, -0.52989480436963, -0.22844135423287654, 0.12304242628451147, -0.2889161833544318, 0.08747884529922964, 0.13758100318035021, -0.026402539608504187, 0.4094662809639149, -0.37547231871800024, -0.6262286494017046, 0.15029977871404931, -0.12997053082658683, -0.1763342752918758, -0.30110301478703255, 0.1238770181315828, -0.27853788399708546, -0.011385339366401107, 0.06340865783443779, 0.22998844453645165, 0.14554672307701724, 0.14588072698152105, 0.19215046171109026, 0.23217294880282738, -0.02777602190107966, 0.14519310423622545, 0.022296347351335552, 0.08507074789018108, -0.13421977259718623, 0.17397269602332796, 0.20565675575344358, 0.11462213438030461, 0.013678920505048296, -0.04949600136305787, -0.042114645936264294, 0.11397020732621094, -0.09360684360982245, 0.27754117780570664, -0.09830634201586537, -0.15827514513484173, 0.03509273089928093, 0.17108478904575777, 0.06996282985625442, -0.07660926078158951, -0.14700349603908627, -0.08123921089208971, 0.011696741450693885, 0.0356810629597377, 0.1429573937368809, -0.0912580355414637, -0.2993503954068121, 0.0010195131735469, -0.0008611494842191022, -0.13105083096369263, -0.10407230089270425, -0.04088847893784105, 0.09477302875490738, 0.027555720681360887, 0.189190603104164, -0.16212289071889813, -0.14236131141141653, 0.10323295851283933, -0.045352699328794745, -0.1310267973223044, 0.1823812272571389, 0.09453157096492425, 0.5450177682240106, -0.0534495823153091, 0.07031157045405423, -0.1438067066072319, 0.16684228022920483, -0.2934232783923329, -0.01777412335592467, -0.02777602190107966, 0.3836773669325585, -0.14003723494069514, -0.17595104654679916, -0.12941041593235017, 0.3193602723295012, -0.05329951857454778, -0.23653982442391314, -0.1894065379921208, 0.09157286674305858, -0.03130737625220647, -0.10390759513403483, 0.17907571401949005, 0.0017270768288164139, -0.07791276366030596, 0.10069277920267339, 0.16328155190518476, 0.06389904694220715, -0.17430095916576768, 0.12607154742255203, 0.19839694695326993, 0.28779964248623063, 0.2896301393487198, -0.038915525369922675, 0.09201317948659911, -0.13524485141849266, 0.3111504820712693, 0.19566841591506626, -0.12274474521825499, 0.11208916982159108, -0.06213047501290907, 0.3371472685895729, -0.09283068345038188, -0.2090132971671566, -0.11508465036548254, -0.2215285809310375, 0.1929188350398795, 0.07128433441987235, -0.07429246042667988, -0.11208703221965471, 0.031545589425101134, -0.18256533376667458, 0.02090773389849598, -0.06951721083127402, 0.05441876025491463, 0.11778266855027704, -0.2530340089974043, 1.173024695196443, 0.33881071662046497, 0.3849731954908426, 0.14519310423622545, -0.14003723494069514, 0.7777565945295044, -0.7174854777360867, -0.08402639093270597, -0.011185722025756389, 0.08628570412049771, 0.23144676028791658, 0.02627668532079239, -0.5491573586344348, 0.024366798858187017, -0.02019370989156363, 0.0066551137098929646, -0.9588273493759737, 0.9079966453892416, -0.003378877188885399, 0.09213267268084828, 1.3131840498009857, 0.7963334140053409, -0.08542356351600129, 0.8941282962993577, -0.07263181043756538, -0.2208446778593992, 0.3103572742568402, -0.6476909525724804, -0.8959831643660524, -0.34007399544305295, -0.6302472690726505, -0.6002174854815385, -0.4684010296155703, 0.3198478025503787, -0.5769629492084859, 0.5117521871494943, 0.3019864120809523, -0.1451189852493928, 0.5109538341102138, -0.4678139015606875, -0.9187150220442019, 0.20350688238305167, 0.020801398573086487, -0.05488703993888919, -0.5444017782161359, 0.09784466849792713, -2.302284395552517, -0.2257627761077027, -0.5381378151463482, 1.1431644557989153, -2.3280054064394977, 0.07462107309692607, -0.6072622785608595, 0.022296347351335552, -0.17595104654679916, -0.7174854777360867, 2.200982903737496, 0.4871959992212665, -1.2360953539576647, 0.2998342048231204, 0.5692158650173614, 0.823711265536122, 1.0644446504242653, -0.41812140437776124, 0.48825116306847743, 0.010285675429569726, 2.1161586676383575, -0.884090522640028, -0.43289464329437904, -0.9437990598114473, -2.5292758394798436, -0.4492722577399179, 0.013942860079469618, -2.1917743666275724, -1.3221629612705794, 0.02723360661081607, -0.6354096694987669, 1.1279691441405, 2.56865427767235, -0.3103990008353026, -0.6455822355242736, 1.6595375577260203, 0.6014706880604501, -1.1592489772744767, 0.10484722816708873, -0.4179678477634559, 0.22349347360553098, 0.3041259113820552, -0.5028928886464539, 0.27201046072769086, 1.1880173601414297, -0.09453529909209779, 0.46006143495466184, -0.20614854530045296, 1.6338256747573967, 0.09032623567526708, -0.6998123882314379, -0.0148341085612915, -0.11970374926672725, 0.37464862161465967, -0.4846721294264257, 0.18270595860613098, -0.04187422425440287, 0.08507074789018108, -0.12941041593235017, -0.08402639093270597, 0.4871959992212665, 0.2283596135927611, -0.3420245590809837, 0.1330545208532589, 0.25153935025405294, 0.2778761531942871, 0.2212135906677413, -0.0803672642073593, 0.13900516202796284, -0.0017469019934462455, 0.41524724954257425, -0.07789662155632668, -0.20417370357757808, -0.29357897358552404, -0.5903836631022487, -0.013392710063734508, 0.007029738439019221, -0.5826618665237044, -0.39589685876614383, -0.08231250197546647, -0.1585922923353924, 0.1999732009659166, 0.6128348776271659, -0.2094169593033143, -0.27503634561821355, 0.3855210828685627, 0.08163407294383047, -0.22908484189036843, -0.0983525297884024, -0.10280170041900955, 0.12150192027949593, 0.12125804489310145, 0.003798057965365303, -0.08275205681401858, 0.20103249922105101, 0.03677508895973462, 0.08990853680681594, -0.11538016295612354, 0.5020673750576853, 0.0439429584380846, 2.3891537968036354, 0.1589771509711183, 0.5012878322986749, -0.848809463335942, 0.8382531411269906, -0.5084970751775678, 0.09413029864799329, -0.13421977259718623, 0.3193602723295012, -0.011185722025756389, -1.2360953539576647, -0.3420245590809837, 1.3541338732734411, -0.5558303653436927, -0.859885938766098, -0.8732094316213347, -0.4444067875521249, 0.4709529064584209, -0.38145599130430213, -0.1362511122203432, -0.8242695360702919, -0.3286919781607797, 0.4282500924873347, 0.9433044419377222, 0.921258717429425, -0.5120553463930542, 0.122116062115259, 1.0551000220237352, 1.3053962048613243, 0.23421041057048492, 0.21743505002261498, -0.5075761645712292, -1.497801518711217, 0.6826499690164639, 1.461595312627506, -0.884112328807521, -0.07993354661696594, 0.8868452963946, 0.5029574746246857, -0.112157590340831, -0.6309958212169339, -0.13202912525802013, -0.05661320386790102, 0.28201651880618395, -0.09935136536786633, -0.07836294974150536, -0.44462343949822175, 0.3739197293927619, -0.980164684786012, -0.23970401698274404, -1.0389877955828672, -0.05531317323926046, -0.18454910853254766, 0.4295743249886676, 0.12474331850799816, 0.3309144371137974, 0.227060514808576, 0.17397269602332796, -0.05329951857454778, 0.08628570412049771, 0.2998342048231204, 0.1330545208532589, -0.5558303653436927, 0.5873035448565534, 0.4457087726235121, 0.36986550922166894, 0.14354311086758528, -0.2934225286078678, 0.045066818872525144, 0.30228220390512717, -0.01061658641220639, 0.5760835563190013, -0.2565424788884569, -0.54351148634736, -0.0727443373356835, 0.3981524126032265, -0.036265117583037416, -0.23651728334417868, -0.49746684462566826, -0.06771285154038306, -0.06433036100730406, 0.24179042637451204, 0.5207553729963049, -0.2808943004738056, -0.9433833924610948, 0.1795312364765562, -0.020782656282785215, -0.5068522557399631, -0.23424919625165674, 0.045644411446095254, 0.3658893908356398, 0.029913356917972266, 0.14914055642723287, -0.2844099762991728, -0.24026575055319335, 0.04570251957783642, 0.08967811836485685, -0.3903490130205133, 0.4031120061882343, 0.23379317826681137, -1.663486913848699, -0.05465743520253517, -0.3233879309478448, 0.5886736144725792, -0.1241035261260924, 0.5362408972498497, 0.12823634657060862, 0.20565675575344358, -0.23653982442391314, 0.23144676028791658, 0.5692158650173614, 0.25153935025405294, -0.859885938766098, 0.4457087726235121, 0.7759144122838418, 0.6597129295055515, 0.16040585784093644, -0.2876281234125517, 0.26538796739117543, 0.14784122176744796, 0.2040738226682879, 0.6151343665336051, -0.3747159968128879, -0.6460754890987477, -0.23335820023988443, 0.6517717797812118, -0.05384788418354243, -0.49336805343551327, -0.9059382768162603, -0.2277448314745007, -0.08347007424766158, 0.12887483484826362, 0.7243613731726254, -0.6363331364634148, -1.2793513262615785, 0.3866465392631168, -0.14149685629425787, -0.46451903101621506, -0.5198125468722032, 0.1886251249320168, 0.5186812995410942, 0.05512009371333106, 0.2284092022920354, -0.4424172547966891, -0.23913797424625702, 0.15514273003777473, 0.24507002880999668, -0.30049225088828535, 0.5939892020530178, 0.23224967395819374, -1.7729154781009537, -0.08404022526630962, -0.41264156114636596, 0.692257106453809, -0.5155431981944556, 0.4786939447889209, -0.0005565306836198935, 0.11462213438030461, -0.1894065379921208, 0.02627668532079239, 0.823711265536122, 0.2778761531942871, -0.8732094316213347, 0.36986550922166894, 0.6597129295055515, 0.7981619921505443, 0.3305029760919475, -0.37693042486930745, 0.342932142955372, 0.14454203634025947, 0.5515820649816369, 0.3122940655820499, -0.37461074432960884, -0.7082440625486374, -0.6813297166739333, 0.4275600389745973, -0.05416311437720675, -0.8410958610632501, -0.974095428247424, -0.1457196707458707, -0.18441385767810667, 0.32800668863700455, 1.032085306493493, -0.5660291146875653, -1.1293829512556115, 0.6257152563945927, -0.03286612269448447, -0.5971354783358641, -0.379472187887847, 0.04664517713400225, 0.4160038938282009, 0.11077468221862015, -0.02012021902853873, -0.3143216942414819, 0.057553885060539406, 0.07663803661402892, 0.2998871027362317, -0.3041160770690319, 0.7516636250335343, 0.1811554486192894, -0.8216031854605208, -0.14259579844755682, -0.2246596321621426, 0.6254572428672502, -1.3584452854834488, -0.1755048234451933, -0.3812169909627012, 0.013678920505048296, 0.09157286674305858, -0.5491573586344348, 1.0644446504242653, 0.2212135906677413, -0.4444067875521249, 0.14354311086758528, 0.16040585784093644, 0.3305029760919475, 0.8513554938112434, -0.2373038425922857, 0.13985030274058075, 0.14092423896861134, 1.25151200355591, -0.6693906975663831, -0.20533275942449172, -0.4273742391260969, -1.5073202510163475, -0.4557921727290148, 0.13917104913029635, -1.2442420937888046, -0.5626787618172125, 0.27628289028103625, -0.44510548224322927, 0.7378925792169122, 1.469020326124218, 0.09670197157481548, -0.2160172123031981, 0.9163301216674066, 0.43409618576188286, -0.6761328367353114, 0.44393432128227023, -0.34664494055690187, -0.03307038493280085, 0.11834743020132293, -0.5100255932562755, 0.36228650074238483, 0.8603953517516556, -0.15674651141586618, 0.09469016226840576, -0.11239195959889471, 0.9402495532267355, 0.03594646553840292, 0.9521165985517603, 0.1007660148981306, 0.2322156552247173, -0.38272764524000286, 0.11702193684941985, -0.16731655509292764, -0.018205277886400674, -0.04949600136305787, -0.03130737625220647, 0.024366798858187017, -0.41812140437776124, -0.0803672642073593, 0.4709529064584209, -0.2934225286078678, -0.2876281234125517, -0.37693042486930745, -0.2373038425922857, 0.46829035595335866, -0.10272332004855288, -0.2300302605063844, -0.25241731252973076, -0.29430724047326223, 0.11874595763120706, 0.45943558054666356, 0.21783117880959577, -0.3367728139665765, 0.0063717756316444265, 0.291808350949719, 0.5492216691036066, -0.03210302296973003, 0.09348979685268213, -0.289110472867844, -0.5853263097342424, 0.17449565078762563, 0.7347150572450193, -0.30667647956737953, -0.03052331153835569, 0.4768828743291405, 0.060435149815728284, -0.04331936979584458, -0.23487205707674905, 0.039690861435946245, 0.10121671473693095, 0.09093110399151894, 0.06965687461241662, -0.00010746024384463682, -0.1789108418237252, 0.2436942913726759, -0.3365733458284032, -0.13219225169586707, -0.8369327462907251, -0.019541581140436005, -0.2653948563379659, 0.20098438987407624, -0.3940056828489261, 0.2005123484502365, -0.16375846595323978, -0.042114645936264294, -0.10390759513403483, -0.02019370989156363, 0.48825116306847743, 0.13900516202796284, -0.38145599130430213, 0.045066818872525144, 0.26538796739117543, 0.342932142955372, 0.13985030274058075, -0.10272332004855288, 0.36397398856577357, -0.06092242979285311, 0.438831222315331, -0.033595967680373075, -0.20455054910905918, -0.2256984261864518, -0.40013616346535413, 0.18532024636696842, -0.08332482104769251, -0.43301235460752857, -0.5074039899904959, 0.0036471070300836067, -0.18632143053011485, 0.018965655661144474, 0.4399990015754323, -0.36948845937084085, -0.43598383850114647, 0.37550842272257834, -0.1091873801138365, -0.11741985427090712, -0.2550321985614986, 0.14725563927247184, 0.18108218640894366, 0.009227385355333004, -0.06715272029649136, -0.17375096805224363, 0.0790253909856577, 0.019525237021931482, 0.2052197436053957, -0.04665946022667861, 0.33219591359148576, 0.019864591330025765, -0.3219432147090234, -0.07440515326138473, -0.10105176446494724, 0.21039497776085248, 0.25638034164186896, 0.07174626846789701, 0.16604923673395422, 0.11397020732621094, 0.17907571401949005, 0.0066551137098929646, 0.010285675429569726, -0.0017469019934462455, -0.1362511122203432, 0.30228220390512717, 0.14784122176744796, 0.14454203634025947, 0.14092423896861134, -0.2300302605063844, -0.06092242979285311, 0.4072134267077912, -0.05964278210004897, 0.3685290959197524, -0.07167294804333382, -0.257095197736267, 0.06298670320873435, 0.19331639817903637, 0.07903407801978302, 0.004709361227384458, -0.14285109017170297, 0.0907394063416052, -0.011866335458972883, 0.21150296410313757, 0.23003492797613023, 0.029184640725415392, -0.5411827507641598, 0.010703665857269827, 0.04198751367513671, -0.3858599815479413, 0.08624358275343333, -0.05424353881812658, 0.09002816243074507, -0.041018229698111176, -0.06512612345154715, -0.07510128059726838, -0.14317024384236576, 0.01696004886374944, 0.0013707829344113312, -0.2418355624324509, 0.13859870065877708, 0.1507405289982645, -1.5106725189047896, -0.21599980342699804, -0.4491863208825325, 0.9526917075328841, -2.7000873901880067, -0.32815364452546614, -0.8619602650105631, -0.09360684360982245, 0.0017270768288164139, -0.9588273493759737, 2.1161586676383575, 0.41524724954257425, -0.8242695360702919, -0.01061658641220639, 0.2040738226682879, 0.5515820649816369, 1.25151200355591, -0.25241731252973076, 0.438831222315331, -0.05964278210004897, 2.4760074089410677, -1.4971942314204207, -0.30955325128184025, -0.628561689504508, -2.8474135618530885, -0.9419606325168589, 0.10608030724468201, -2.299881264124624, -1.029487565406457, 0.3120990758631288, -0.7666286716694859, 1.1508975776610442, 2.5642454844813196, 0.036263375260476106, -0.028148640682940974, 1.7368586543144042, 0.7745827510295783, -1.000919823048342, 0.5424373475021533, -0.5485124847324953, -0.12043280987674773, 0.28822837430837633, -0.8382349012961643, 0.6196420597420901, 1.6096627571527469, -0.21852345982910681, 0.3288264104527133, -0.008371999224918004, 1.5851568110352285, -0.05320971676966909, -0.7638337973535647, 0.05421816726789701, -0.07236553777755113, -0.03349423822629476, 1.9190237612863075, 0.7245806114171184, 0.7544460363665826, 0.27754117780570664, -0.07791276366030596, 0.9079966453892416, -0.884090522640028, -0.07789662155632668, -0.3286919781607797, 0.5760835563190013, 0.6151343665336051, 0.3122940655820499, -0.6693906975663831, -0.29430724047326223, -0.033595967680373075, 0.3685290959197524, -1.4971942314204207, 1.9385679877524513, -0.20770449930882623, -0.31549745128348167, 1.8305957842619638, 1.4564248994796298, -0.07824183775384172, 1.228685821794937, -0.3055128677271597, -0.33606828344591744, 0.3962270709551171, -0.6287443648243971, -0.9747098486698373, -0.6714010263434752, -1.5347986667953508, -0.7917680258336941, -0.6516651081446421, 0.0325735961120612, -0.8321149139279637, 0.6427954667478042, 0.6459554087000423, -0.20557327734996883, 0.7241111760744744, -0.9148513551438994, -1.4962313530860656, 0.3223541037651163, 0.08073143106507913, -0.3572651265654511, -0.5286269899039102, 0.3900597418368909, 0.9215681861349113, 0.007096273349033612, 0.19175478974456023, -0.3947450602903357, 0.2911196731417783, -0.2907716689866391, -0.0069816728057622, -0.09830634201586537, 0.10069277920267339, -0.003378877188885399, -0.43289464329437904, -0.20417370357757808, 0.4282500924873347, -0.2565424788884569, -0.3747159968128879, -0.37461074432960884, -0.20533275942449172, 0.11874595763120706, -0.20455054910905918, -0.07167294804333382, -0.30955325128184025, -0.20770449930882623, 0.3478489418169967, 0.3674682196776697, 0.4421688342729414, -0.21206071930651596, -0.004687235346376428, 0.493012332717628, 0.5367068636584704, 0.05317848178432565, 0.19461346633608848, -0.12198819457386642, -0.5766285526593421, 0.3690837184651412, 0.6036380278212381, -0.35970155778742147, 0.03779352511575615, 0.268933314521922, 0.19285007010416624, -0.020937272548107067, -0.23459468774743442, -0.07684023407181055, -0.023514071585856444, 0.2251774087499069, -0.027243117662491902, -0.05776577426204297, -0.1282825558128385, 0.16678377125261037, -0.4947426242206314, -0.1374237061595016, 1.7915372694477574, 0.1033506720194727, 0.39224245584777, -0.8085306872205068, 0.5994396521812264, -0.3948091062336446, -0.02809557916941242, -0.15827514513484173, 0.16328155190518476, 0.09213267268084828, -0.9437990598114473, -0.29357897358552404, 0.9433044419377222, -0.54351148634736, -0.6460754890987477, -0.7082440625486374, -0.4273742391260969, 0.45943558054666356, -0.2256984261864518, -0.257095197736267, -0.628561689504508, -0.31549745128348167, 0.3674682196776697, 0.8776162340076367, 0.8250411420491941, -0.32638053064443384, 0.031841716093963184, 0.920843651298929, 0.971377682129407, 0.11718133790708787, 0.21173045873138635, -0.5332062135138799, -1.2684719002270393, 0.4433524325885155, 1.1425891176547258, -0.7053385279074743, -0.13472546869623314, 0.8011406317563804, 0.2432280284518656, 0.06572969120428232, -0.4082840402652983, -0.14826481533721614, 0.02613789545060176, 0.2435687101293694, -0.11179430491627759, -0.06544940237422803, -0.25800372274894645, 0.4015273185937919, -0.8872181077944694, -0.23266769653588995, 1.7233694752876005, 0.1965506910549747, 0.43723464108814053, -1.3600972359735863, 3.3512325257229625, 0.23710991895888645, 0.86433601887177, 0.03509273089928093, 0.06389904694220715, 1.3131840498009857, -2.5292758394798436, -0.5903836631022487, 0.921258717429425, -0.0727443373356835, -0.23335820023988443, -0.6813297166739333, -1.5073202510163475, 0.21783117880959577, -0.40013616346535413, 0.06298670320873435, -2.8474135618530885, 1.8305957842619638, 0.4421688342729414, 0.8250411420491941, 3.805634419813987, 1.420154715558433, -0.19043675572528743, 3.0368628060505816, 1.0336562321347373, -0.18849745450163152, 0.8834681189502388, -1.592687500142761, -3.1894961431846265, -0.10499052133475677, -0.30284822557426916, -2.088342927205079, -1.0876238495405377, 1.2783652263784426, -0.7655821269629846, 1.0118272920154454, 0.24678995626918102, -0.5519929214602929, 0.9284734861132663, -0.7693989142341523, -2.105292044896222, 0.2572774496976134, -0.29759980576325223, 0.06446885167497102, -2.105619757216384, 0.016757130788347393, -1.1135846709595885, 0.01848711282534558, -0.23412078079658416, 0.0045549448742518645, 1.3039834549645284, 0.6713601784793372, 0.4338201783254598, 0.17108478904575777, -0.17430095916576768, 0.7963334140053409, -0.4492722577399179, -0.013392710063734508, -0.5120553463930542, 0.3981524126032265, 0.6517717797812118, 0.4275600389745973, -0.4557921727290148, -0.3367728139665765, 0.18532024636696842, 0.19331639817903637, -0.9419606325168589, 1.4564248994796298, -0.21206071930651596, -0.32638053064443384, 1.420154715558433, 1.4570062937316415, -0.1545107752263752, 0.8296363027638882, -0.6368687262824279, -0.26168981082265547, 0.24224819342603818, -0.5820681038315608, -0.6063402826227177, -0.7793153962345433, -1.5550597810092708, -0.43742302483404677, -0.6895619085716216, 0.0835334534277319, -0.8697171164740739, 0.7249294688241548, 0.6656807667508825, -0.2554190527421221, 0.5496562911220713, -0.8130936302824523, -1.2053593283342054, 0.25657564878348055, 0.22346047849401665, -0.26176863055655436, -0.3197533109382087, 0.22078287180959308, 0.21134692386913798, -0.012714112876527399, 0.10513304813994796, 0.09987703084385903, -0.11715134415358257, -0.1358618833244379, -0.00868154448958001, 0.06996282985625442, 0.12607154742255203, -0.08542356351600129, 0.013942860079469618, 0.007029738439019221, 0.122116062115259, -0.036265117583037416, -0.05384788418354243, -0.05416311437720675, 0.13917104913029635, 0.0063717756316444265, -0.08332482104769251, 0.07903407801978302, 0.10608030724468201, -0.07824183775384172, -0.004687235346376428, 0.031841716093963184, -0.19043675572528743, -0.1545107752263752, 0.19975006676273968, -0.08974054278761, 0.08614930037134912, 0.08011968514048474, -0.05378034614691777, 0.12129299255593257, 0.13124516832755145, 0.15742495344590912, 0.1574989188816479, 0.04909210915547227, 0.15623599485645384, -0.07799855442968645, 0.22630275845413753, -0.15730551703175877, -0.10093437408983558, 0.008910384227353393, -0.07787617907389692, 0.1226997553133426, 0.15457559661567563, 0.006484399279534163, -0.08769647864816742, 0.0483968124171977, 0.10028144089794193, 0.048156485361424056, 2.048841196772891, 0.15692105208513493, 0.4691010906545292, -1.3328351681451054, 2.6850441053566256, -0.08070535665535211, 0.5972946723603575, -0.07660926078158951, 0.19839694695326993, 0.8941282962993577, -2.1917743666275724, -0.5826618665237044, 1.0551000220237352, -0.23651728334417868, -0.49336805343551327, -0.8410958610632501, -1.2442420937888046, 0.291808350949719, -0.43301235460752857, 0.004709361227384458, -2.299881264124624, 1.228685821794937, 0.493012332717628, 0.920843651298929, 3.0368628060505816, 0.8296363027638882, -0.08974054278761, 2.676194294206949, 1.2164268392298343, -0.04486899100516185, 0.7359969901872367, -1.2730804251097554, -2.7914620673187778, 0.20517540033936935, 0.2986151411596512, -1.797685028031686, -0.7263200106359192, 1.1415332790812904, -0.35549001921680395, 0.7153815517196275, -0.005218593160656091, -0.46312632754400224, 0.6293913368211285, -0.3733283148185669, -1.544011970312672, 0.14225955380027303, -0.31990601939085955, 0.2157649817155146, -1.9182663015834789, -0.031076877253546856, 2.5848581285076215, 0.14142059578312344, 0.562058177046131, -0.934817605875236, 0.9459190779217233, -0.5530879535926385, 0.19743976801496757, -0.14700349603908627, 0.28779964248623063, -0.07263181043756538, -1.3221629612705794, -0.39589685876614383, 1.3053962048613243, -0.49746684462566826, -0.9059382768162603, -0.974095428247424, -0.5626787618172125, 0.5492216691036066, -0.5074039899904959, -0.14285109017170297, -1.029487565406457, -0.3055128677271597, 0.5367068636584704, 0.971377682129407, 1.0336562321347373, -0.6368687262824279, 0.08614930037134912, 1.2164268392298343, 1.6563744585049134, 0.13560591767535513, 0.37558586897233753, -0.41258126521056965, -1.6415630071234055, 0.8090895230022311, 1.6757185846454266, -1.036694989599735, 0.03249519997953691, 0.8521069994958892, 0.4547210246156115, -0.2192539266106225, -0.6150730999639092, -0.07498378658307378, 0.08068551419989219, 0.3145105575937052, -0.09431296592055935, -0.08402301677463382, -0.5246381958796404, 0.3497340757720116, -1.1042909735157067, -0.22913779441161924, 0.4591547533297519, -0.054385864672465735, 0.015166077144288768, -0.11303117818818405, -0.1785684851966738, -0.3760894532944277, -0.18495098345289088, -0.08123921089208971, 0.2896301393487198, -0.2208446778593992, 0.02723360661081607, -0.08231250197546647, 0.23421041057048492, -0.06771285154038306, -0.2277448314745007, -0.1457196707458707, 0.27628289028103625, -0.03210302296973003, 0.0036471070300836067, 0.0907394063416052, 0.3120990758631288, -0.33606828344591744, 0.05317848178432565, 0.11718133790708787, -0.18849745450163152, -0.26168981082265547, 0.08011968514048474, -0.04486899100516185, 0.13560591767535513, 0.5016632879173456, -0.2015988078446191, 0.09735332326175032, 0.10007244612370493, 0.2905153825937758, 0.1543954101332299, 0.11204326464467504, 0.110187191748659, -0.05348179301618925, 0.36657206727667296, -0.0005537521275459865, -0.19255308875039237, -0.12206380315951738, -0.336912239654349, 0.22281403841321795, 0.2718477526802186, -0.1523662419794596, -0.14748571807506444, 0.02314261024380385, -0.0019813456803104675, -0.03160331514088091, 0.4866979337185299, 0.03712640033401871, 0.1414714142121072, -0.32877753954289596, 0.8126348262430809, 0.07296703881803836, 0.2697553394683959, 0.011696741450693885, -0.038915525369922675, 0.3103572742568402, -0.6354096694987669, -0.1585922923353924, 0.21743505002261498, -0.06433036100730406, -0.08347007424766158, -0.18441385767810667, -0.44510548224322927, 0.09348979685268213, -0.18632143053011485, -0.011866335458972883, -0.7666286716694859, 0.3962270709551171, 0.19461346633608848, 0.21173045873138635, 0.8834681189502388, 0.24224819342603818, -0.05378034614691777, 0.7359969901872367, 0.37558586897233753, -0.2015988078446191, 0.3945370514637758, -0.3009264200710626, -0.8012954550561217, 0.07187698797173636, 0.11405205593185874, -0.5698235379861923, -0.16107048205609, 0.2763721010553977, -0.19739542583738923, 0.12070101944218668, 0.009816909746301675, -0.0560596482813191, 0.28744509772476196, -0.10488036559259688, -0.4648988627077111, 0.0883996217847271, -0.06333171619770424, 0.05857958370003269, -0.5589601974673925, -0.01581149687575533, -0.8686349111349915, -0.16902785133763512, -0.19894084995664787, 0.7069785441574208, -1.308882472048767, -0.14218198717260347, -0.257322956524922, 0.0356810629597377, 0.09201317948659911, -0.6476909525724804, 1.1279691441405, 0.1999732009659166, -0.5075761645712292, 0.24179042637451204, 0.12887483484826362, 0.32800668863700455, 0.7378925792169122, -0.289110472867844, 0.018965655661144474, 0.21150296410313757, 1.1508975776610442, -0.6287443648243971, -0.12198819457386642, -0.5332062135138799, -1.592687500142761, -0.5820681038315608, 0.12129299255593257, -1.2730804251097554, -0.41258126521056965, 0.09735332326175032, -0.3009264200710626, 1.0061843026611386, 1.533318209997076, 0.22072389215462387, -0.04552686971929078, 0.8681331454134645, 0.6025887046546727, -0.8737222031533347, 0.4466528457700899, -0.5829475113497189, -0.0742251888961395, 0.2124563162667395, -0.43651634778487947, 0.42529224271137794, 0.8782738086808141, -0.13697018947617778, 0.11324246011337183, -0.18389391373938205, 0.9275559588596213, 0.06133383115906626, -2.756886513921411, -0.2897601460377601, -0.6115952657468746, 1.588061328207695, -2.8142611895198835, 0.06899742128077524, -0.6262125434319477, 0.1429573937368809, -0.13524485141849266, -0.8959831643660524, 2.56865427767235, 0.6128348776271659, -1.497801518711217, 0.5207553729963049, 0.7243613731726254, 1.032085306493493, 1.469020326124218, -0.5853263097342424, 0.4399990015754323, 0.23003492797613023, 2.5642454844813196, -0.9747098486698373, -0.5766285526593421, -1.2684719002270393, -3.1894961431846265, -0.6063402826227177, 0.13124516832755145, -2.7914620673187778, -1.6415630071234055, 0.10007244612370493, -0.8012954550561217, 1.533318209997076, 3.377574036104274, -0.2540545055912848, -0.9482405865210556, 2.0556730681593285, 0.8642552676783205, -1.6375195188917122, 0.35336153883055593, -0.6496565293852095, 0.2287201029524304, 0.4195614901519062, -0.6869899089821087, 0.3953223570340688, 1.5012066535193178, -0.13996144437511832, 0.4616519460784931, -0.37971376858022693, 2.1628819079764394, 0.1894154830358961, 1.4355360924708305, -0.0388560335221398, 0.3304999252087013, -0.32647557278472406, -0.08854748059765666, -0.622516877022471, -0.10401433154670481, -0.0912580355414637, 0.3111504820712693, -0.34007399544305295, -0.3103990008353026, -0.2094169593033143, 0.6826499690164639, -0.2808943004738056, -0.6363331364634148, -0.5660291146875653, 0.09670197157481548, 0.17449565078762563, -0.36948845937084085, 0.029184640725415392, 0.036263375260476106, -0.6714010263434752, 0.3690837184651412, 0.4433524325885155, -0.10499052133475677, -0.7793153962345433, 0.15742495344590912, 0.20517540033936935, 0.8090895230022311, 0.2905153825937758, 0.07187698797173636, 0.22072389215462387, -0.2540545055912848, 0.8460712425477673, 1.0983048596173661, -0.21433158620300974, 0.3725289757698936, 0.08564337550896296, 0.6845130683751313, -0.38186750802068337, -0.5135243670016052, -0.01943251263421811, -0.3001945604022302, 0.6085478288962534, 0.4278223507434636, -0.17462807548545842, -0.2917500322511157, 0.18247176947437016, -0.3146912594436038, -0.14569182467627748, 2.916604858302512, 0.1653866030284994, 0.6984143854986102, -0.8022994854466539, -0.43830659211881345, -0.8879741766082235, -0.29639599418589135, -0.2993503954068121, 0.19566841591506626, -0.6302472690726505, -0.6455822355242736, -0.27503634561821355, 1.461595312627506, -0.9433833924610948, -1.2793513262615785, -1.1293829512556115, -0.2160172123031981, 0.7347150572450193, -0.43598383850114647, -0.5411827507641598, -0.028148640682940974, -1.5347986667953508, 0.6036380278212381, 1.1425891176547258, -0.30284822557426916, -1.5550597810092708, 0.1574989188816479, 0.2986151411596512, 1.6757185846454266, 0.1543954101332299, 0.11405205593185874, -0.04552686971929078, -0.9482405865210556, 1.0983048596173661, 2.9022733974275763, -0.43918798722680036, 0.46169478732854674, 0.9450611996779307, 0.9070437755733396, -0.6933457878115284, -1.0207665199033757, 0.12686458543530116, -0.26941892505166304, 0.8495256697376625, 0.8579934221152916, -0.20692994350344204, -0.5097731923992878, 0.6797828471733285, -0.6598988682159702, -0.47257728298615764, -1.6469966428420402, -0.14649424075209475, -0.41640779330437494, 0.9087616662236305, -1.9311268904861627, -0.001583051698068681, -0.52989480436963, 0.0010195131735469, -0.12274474521825499, -0.6002174854815385, 1.6595375577260203, 0.3855210828685627, -0.884112328807521, 0.1795312364765562, 0.3866465392631168, 0.6257152563945927, 0.9163301216674066, -0.30667647956737953, 0.37550842272257834, 0.010703665857269827, 1.7368586543144042, -0.7917680258336941, -0.35970155778742147, -0.7053385279074743, -2.088342927205079, -0.43742302483404677, 0.04909210915547227, -1.797685028031686, -1.036694989599735, 0.11204326464467504, -0.5698235379861923, 0.8681331454134645, 2.0556730681593285, -0.21433158620300974, -0.43918798722680036, 1.3904347903704728, 0.5085569229028973, -0.877716464863191, 0.21673524365391486, -0.3376095520521643, 0.09936309430972992, 0.25732783488746336, -0.4955293892752137, 0.25238197993013395, 1.0434336155953436, -0.10727555471131764, 0.31045458439292684, -0.13264591659022115, 1.336572668891816, 0.05114622065674229, 0.04544239512902233, -0.08385666884292417, 0.03509780709619646, 0.3161647765159817, -0.9324547956626685, -0.34963367571006027, -0.22844135423287654, -0.0008611494842191022, 0.11208916982159108, -0.4684010296155703, 0.6014706880604501, 0.08163407294383047, -0.07993354661696594, -0.020782656282785215, -0.14149685629425787, -0.03286612269448447, 0.43409618576188286, -0.03052331153835569, -0.1091873801138365, 0.04198751367513671, 0.7745827510295783, -0.6516651081446421, 0.03779352511575615, -0.13472546869623314, -1.0876238495405377, -0.6895619085716216, 0.15623599485645384, -0.7263200106359192, 0.03249519997953691, 0.110187191748659, -0.16107048205609, 0.6025887046546727, 0.8642552676783205, 0.3725289757698936, 0.46169478732854674, 0.5085569229028973, 0.6233037473798378, -0.44139422927515426, 0.4758157229858342, -0.4564713005582677, -0.24122796444122546, 0.18116613672554363, -0.288210978291574, 0.4526166604050068, 0.72966034050792, -0.10139855427017891, -0.0447818691034381, 0.031058610528526077, 0.4876122622698281, 0.00022017621222552864, 1.624097404137155, 0.2328507681290349, 0.34528595267109635, -0.845100232955722, 0.9506334999473403, -0.09347529983994636, 0.12304242628451147, -0.13105083096369263, -0.06213047501290907, 0.3198478025503787, -1.1592489772744767, -0.22908484189036843, 0.8868452963946, -0.5068522557399631, -0.46451903101621506, -0.5971354783358641, -0.6761328367353114, 0.4768828743291405, -0.11741985427090712, -0.3858599815479413, -1.000919823048342, 0.0325735961120612, 0.268933314521922, 0.8011406317563804, 1.2783652263784426, 0.0835334534277319, -0.07799855442968645, 1.1415332790812904, 0.8521069994958892, -0.05348179301618925, 0.2763721010553977, -0.8737222031533347, -1.6375195188917122, 0.08564337550896296, 0.9450611996779307, -0.877716464863191, -0.44139422927515426, 1.2091543116315684, -0.15193630034949637, 0.27478582521049844, -0.2290264564582693, -0.16418987227264625, 0.3219875028274764, -0.16906475389398457, -0.46031053742217715, 0.05906127539597395, -0.2872138239422728, 0.37869962879266084, -0.9402784650894701, -0.26114755857843974, 0.9869074051582544, -0.03517568069718802, 0.17234246772302725, -0.012943830707756041, -0.6728884119252186, -0.5875878961614104, -0.2889161833544318, -0.10407230089270425, 0.3371472685895729, -0.5769629492084859, 0.10484722816708873, -0.0983525297884024, 0.5029574746246857, -0.23424919625165674, -0.5198125468722032, -0.379472187887847, 0.44393432128227023, 0.060435149815728284, -0.2550321985614986, 0.08624358275343333, 0.5424373475021533, -0.8321149139279637, 0.19285007010416624, 0.2432280284518656, -0.7655821269629846, -0.8697171164740739, 0.22630275845413753, -0.35549001921680395, 0.4547210246156115, 0.36657206727667296, -0.19739542583738923, 0.4466528457700899, 0.35336153883055593, 0.6845130683751313, 0.9070437755733396, 0.21673524365391486, 0.4758157229858342, -0.15193630034949637, 0.9330417594910464, -0.4731596945884972, -0.5103775690887647, 0.037519861404129884, -0.5484097420484094, 0.6559445633728347, 0.7367750576132562, -0.21885094897498253, -0.19285354246687836, 0.17051418893985668, 0.12360533195739076, -0.08870838119336193, -0.22531687540564085, 0.030958022470706954, -0.09366651806702184, -0.3169288769251217, 0.7662668127801423, 0.19234790858421555, 0.08747884529922964, -0.04088847893784105, -0.09283068345038188, 0.5117521871494943, -0.4179678477634559, -0.10280170041900955, -0.112157590340831, 0.045644411446095254, 0.1886251249320168, 0.04664517713400225, -0.34664494055690187, -0.04331936979584458, 0.14725563927247184, -0.05424353881812658, -0.5485124847324953, 0.6427954667478042, -0.020937272548107067, 0.06572969120428232, 1.0118272920154454, 0.7249294688241548, -0.15730551703175877, 0.7153815517196275, -0.2192539266106225, -0.0005537521275459865, 0.12070101944218668, -0.5829475113497189, -0.6496565293852095, -0.38186750802068337, -0.6933457878115284, -0.3376095520521643, -0.4564713005582677, 0.27478582521049844, -0.4731596945884972, 0.6685457499733687, 0.31834236440198393, -0.2126447325011058, 0.24963771078913993, -0.36698996583765847, -0.6892037866417887, 0.07941885183458983, 0.11683311521297661, 0.0033829518665612003, -0.4571378342468592, 0.05971443602987626, -1.18358591063745, -0.03708569625167789, -0.20971266112192555, 0.25014647555631386, 0.1926272293734586, 0.426873756183646, 0.13758100318035021, 0.09477302875490738, -0.2090132971671566, 0.3019864120809523, 0.22349347360553098, 0.12150192027949593, -0.6309958212169339, 0.3658893908356398, 0.5186812995410942, 0.4160038938282009, -0.03307038493280085, -0.23487205707674905, 0.18108218640894366, 0.09002816243074507, -0.12043280987674773, 0.6459554087000423, -0.23459468774743442, -0.4082840402652983, 0.24678995626918102, 0.6656807667508825, -0.10093437408983558, -0.005218593160656091, -0.6150730999639092, -0.19255308875039237, 0.009816909746301675, -0.0742251888961395, 0.2287201029524304, -0.5135243670016052, -1.0207665199033757, 0.09936309430972992, -0.24122796444122546, -0.2290264564582693, -0.5103775690887647, 0.31834236440198393, 0.5463776792046358, -0.03578610991815698, 0.2516608248335648, -0.3822897843847422, -0.40890106430247997, 0.10209715020979676, 0.21844222949629105, -0.22569027140847453, 0.20427457120114112, 0.1766811979201182, -0.23533781903323686, 0.012839118949287808, -0.028231959519766724, 0.2422854845679856, -0.4568156667179388, 0.061036083035421, -0.026402539608504187, 0.027555720681360887, -0.11508465036548254, -0.1451189852493928, 0.3041259113820552, 0.12125804489310145, -0.13202912525802013, 0.029913356917972266, 0.05512009371333106, 0.11077468221862015, 0.11834743020132293, 0.039690861435946245, 0.009227385355333004, -0.041018229698111176, 0.28822837430837633, -0.20557327734996883, -0.07684023407181055, -0.14826481533721614, -0.5519929214602929, -0.2554190527421221, 0.008910384227353393, -0.46312632754400224, -0.07498378658307378, -0.12206380315951738, -0.0560596482813191, 0.2124563162667395, 0.4195614901519062, -0.01943251263421811, 0.12686458543530116, 0.25732783488746336, 0.18116613672554363, -0.16418987227264625, 0.037519861404129884, -0.2126447325011058, -0.03578610991815698, 0.22162925206909453, -0.030293025416135586, 0.047142716909202374, 0.28996823771872093, 0.011558595241712169, 0.01944050700842386, -0.017492125236713507, 0.32282182119567077, 0.012741568005816141, -0.03716820663311902, 0.08751778969970568, 0.16552048491654733, -0.11782381468490058, 0.8754690435351562, 0.35764243354216557, 0.4094662809639149, 0.189190603104164, -0.2215285809310375, 0.5109538341102138, -0.5028928886464539, 0.003798057965365303, -0.05661320386790102, 0.14914055642723287, 0.2284092022920354, -0.02012021902853873, -0.5100255932562755, 0.10121671473693095, -0.06715272029649136, -0.06512612345154715, -0.8382349012961643, 0.7241111760744744, -0.023514071585856444, 0.02613789545060176, 0.9284734861132663, 0.5496562911220713, -0.07787617907389692, 0.6293913368211285, 0.08068551419989219, -0.336912239654349, 0.28744509772476196, -0.43651634778487947, -0.6869899089821087, -0.3001945604022302, -0.26941892505166304, -0.4955293892752137, -0.288210978291574, 0.3219875028274764, -0.5484097420484094, 0.24963771078913993, 0.2516608248335648, -0.030293025416135586, 0.6616202378681875, -0.4696123017087071, -0.6960282357170895, 0.2131798005297385, -0.06953213486296779, -0.07575355601365964, -0.30811955956165604, 0.07083206690349454, 0.6547433848685114, -0.09656049348214375, 0.154983642983464, -0.06919785135342978, -0.7900251493359477, -0.546343197606633, -0.37547231871800024, -0.16212289071889813, 0.1929188350398795, -0.4678139015606875, 0.27201046072769086, -0.08275205681401858, 0.28201651880618395, -0.2844099762991728, -0.4424172547966891, -0.3143216942414819, 0.36228650074238483, 0.09093110399151894, -0.17375096805224363, -0.07510128059726838, 0.6196420597420901, -0.9148513551438994, 0.2251774087499069, 0.2435687101293694, -0.7693989142341523, -0.8130936302824523, 0.1226997553133426, -0.3733283148185669, 0.3145105575937052, 0.22281403841321795, -0.10488036559259688, 0.42529224271137794, 0.3953223570340688, 0.6085478288962534, 0.8495256697376625, 0.25238197993013395, 0.4526166604050068, -0.16906475389398457, 0.6559445633728347, -0.36698996583765847, -0.3822897843847422, 0.047142716909202374, -0.4696123017087071, 0.7777476383232839, 0.71405199329016, -0.22020670697291572, -0.04227939109733475, 0.21914749948001463, 0.0639635681366535, -0.13054594090823246, -0.06363573352240258, -0.09996088573351065, -0.10499133940512975, 0.45998659700263045, -2.003271724834259, -0.489160123898812, -0.6262286494017046, -0.14236131141141653, 0.07128433441987235, -0.9187150220442019, 1.1880173601414297, 0.20103249922105101, -0.09935136536786633, -0.24026575055319335, -0.23913797424625702, 0.057553885060539406, 0.8603953517516556, 0.06965687461241662, 0.0790253909856577, -0.14317024384236576, 1.6096627571527469, -1.4962313530860656, -0.027243117662491902, -0.11179430491627759, -2.105292044896222, -1.2053593283342054, 0.15457559661567563, -1.544011970312672, -0.09431296592055935, 0.2718477526802186, -0.4648988627077111, 0.8782738086808141, 1.5012066535193178, 0.4278223507434636, 0.8579934221152916, 1.0434336155953436, 0.72966034050792, -0.46031053742217715, 0.7367750576132562, -0.6892037866417887, -0.40890106430247997, 0.28996823771872093, -0.6960282357170895, 0.71405199329016, 1.5098645296744766, -0.2608072109269972, -0.007902716906395796, 0.16604132056325469, 0.9349705871340346, -0.17629493800971419, -0.18415499069420413, 0.03191737279015718, 0.012867289597941643, 0.05087935847321473, 0.2777578229967351, 0.1709531714519369, 0.15029977871404931, 0.10323295851283933, -0.07429246042667988, 0.20350688238305167, -0.09453529909209779, 0.03677508895973462, -0.07836294974150536, 0.04570251957783642, 0.15514273003777473, 0.07663803661402892, -0.15674651141586618, -0.00010746024384463682, 0.019525237021931482, 0.01696004886374944, -0.21852345982910681, 0.3223541037651163, -0.05776577426204297, -0.06544940237422803, 0.2572774496976134, 0.25657564878348055, 0.006484399279534163, 0.14225955380027303, -0.08402301677463382, -0.1523662419794596, 0.0883996217847271, -0.13697018947617778, -0.13996144437511832, -0.17462807548545842, -0.20692994350344204, -0.10727555471131764, -0.10139855427017891, 0.05906127539597395, -0.21885094897498253, 0.07941885183458983, 0.10209715020979676, 0.011558595241712169, 0.2131798005297385, -0.22020670697291572, -0.2608072109269972, 0.16976156459894617, 0.014404086256704333, -0.01519801400372057, -0.02658697494211705, 0.06337162882872772, -0.9307530712636556, -0.06953590097874822, -0.2531285803478732, 0.1993767063873512, -0.30645908870063, 0.20743010918074337, -0.12997053082658683, -0.045352699328794745, -0.11208703221965471, 0.020801398573086487, 0.46006143495466184, 0.08990853680681594, -0.44462343949822175, 0.08967811836485685, 0.24507002880999668, 0.2998871027362317, 0.09469016226840576, -0.1789108418237252, 0.2052197436053957, 0.0013707829344113312, 0.3288264104527133, 0.08073143106507913, -0.1282825558128385, -0.25800372274894645, -0.29759980576325223, 0.22346047849401665, -0.08769647864816742, -0.31990601939085955, -0.5246381958796404, -0.14748571807506444, -0.06333171619770424, 0.11324246011337183, 0.4616519460784931, -0.2917500322511157, -0.5097731923992878, 0.31045458439292684, -0.0447818691034381, -0.2872138239422728, -0.19285354246687836, 0.11683311521297661, 0.21844222949629105, 0.01944050700842386, -0.06953213486296779, -0.04227939109733475, -0.007902716906395796, 0.014404086256704333, 0.3480781578189006, -0.05118967919219366, 0.22523804041080794, 0.05000967700653246, 0.743782453557428, 0.053579488761997196, 0.1462637208309831, -0.32503580899155715, -0.10833526433681367, -0.2504484543176086, -0.1763342752918758, -0.1310267973223044, 0.031545589425101134, -0.05488703993888919, -0.20614854530045296, -0.11538016295612354, 0.3739197293927619, -0.3903490130205133, -0.30049225088828535, -0.3041160770690319, -0.11239195959889471, 0.2436942913726759, -0.04665946022667861, -0.2418355624324509, -0.008371999224918004, -0.3572651265654511, 0.16678377125261037, 0.4015273185937919, 0.06446885167497102, -0.26176863055655436, 0.0483968124171977, 0.2157649817155146, 0.3497340757720116, 0.02314261024380385, 0.05857958370003269, -0.18389391373938205, -0.37971376858022693, 0.18247176947437016, 0.6797828471733285, -0.13264591659022115, 0.031058610528526077, 0.37869962879266084, 0.17051418893985668, 0.0033829518665612003, -0.22569027140847453, -0.017492125236713507, -0.07575355601365964, 0.21914749948001463, 0.16604132056325469, -0.01519801400372057, -0.05118967919219366, 0.38455839882719683, -0.3033623662365892, -0.11543634758563712, -1.8803918036482234, -0.11913292472464912, -0.38404891135617947, 1.157977081271793, -1.7863204879471593, 0.22222332014760846, -0.30110301478703255, 0.1823812272571389, -0.18256533376667458, -0.5444017782161359, 1.6338256747573967, 0.5020673750576853, -0.980164684786012, 0.4031120061882343, 0.5939892020530178, 0.7516636250335343, 0.9402495532267355, -0.3365733458284032, 0.33219591359148576, 0.13859870065877708, 1.5851568110352285, -0.5286269899039102, -0.4947426242206314, -0.8872181077944694, -2.105619757216384, -0.3197533109382087, 0.10028144089794193, -1.9182663015834789, -1.1042909735157067, -0.0019813456803104675, -0.5589601974673925, 0.9275559588596213, 2.1628819079764394, -0.3146912594436038, -0.6598988682159702, 1.336572668891816, 0.4876122622698281, -0.9402784650894701, 0.12360533195739076, -0.4571378342468592, 0.20427457120114112, 0.32282182119567077, -0.30811955956165604, 0.0639635681366535, 0.9349705871340346, -0.02658697494211705, 0.22523804041080794, -0.3033623662365892, 1.6083385390627005, 0.13978775171880076, -0.4668592796252492, -0.02178523062533816, -0.04933051323246521, 0.2070891548902233, 0.13571938994736713, 0.14202399185340595, 0.1238770181315828, 0.09453157096492425, 0.02090773389849598, 0.09784466849792713, 0.09032623567526708, 0.0439429584380846, -0.23970401698274404, 0.23379317826681137, 0.23224967395819374, 0.1811554486192894, 0.03594646553840292, -0.13219225169586707, 0.019864591330025765, 0.1507405289982645, -0.05320971676966909, 0.3900597418368909, -0.1374237061595016, -0.23266769653588995, 0.016757130788347393, 0.22078287180959308, 0.048156485361424056, -0.031076877253546856, -0.22913779441161924, -0.03160331514088091, -0.01581149687575533, 0.06133383115906626, 0.1894154830358961, -0.14569182467627748, -0.47257728298615764, 0.05114622065674229, 0.00022017621222552864, -0.26114755857843974, -0.08870838119336193, 0.05971443602987626, 0.1766811979201182, 0.012741568005816141, 0.07083206690349454, -0.13054594090823246, -0.17629493800971419, 0.06337162882872772, 0.05000967700653246, -0.11543634758563712, 0.13978775171880076, 0.23006511355294681;
		VectorXd points_sum(D);
		MatrixXd S(D, D);

		std::shared_ptr<niw_hyperparams> prior = std::make_shared<niw_hyperparams>(1.0, m, D, psi);
		std::shared_ptr<niw_hyperparams> posterior = std::make_shared<niw_hyperparams>(5726.0, m, 5775.0, psi_posterior);

		std::shared_ptr<niw_sufficient_statistics> ss = std::make_shared<niw_sufficient_statistics>(5725.0, points_sum, S);

		double result = object.log_marginal_likelihood(prior, posterior, ss);

		ASSERT_NEAR(-37452.79825172736, result, 0.02);
	}
}